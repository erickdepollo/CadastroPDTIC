{% extends "base_generic.html" %}

{% block content %}
<div class="container mt-4">
        <h2>Detalhes do PDTIC</h2>
        <p><strong>Título:</strong> {{ pdsystem.titulo }}</p>
        <p><strong>Vigência:</strong> {{ pdsystem.vigencia_inicio }} a {{ pdsystem.vigencia_fim }}</p>

    <!-- Editar e Excluir PDTIC -->
    <a href="{% url 'editar_pdsystem' pdsystem.id %}" class="btn btn-light mb-1">Editar PDTIC</a>
    <a href="{% url 'excluir_pdsystem' pdsystem.id %}" class="btn btn-light mb-1">Excluir PDTIC</a>

    <!-- Adicionar nova meta -->
    <a href="{% url 'nova_meta' pdsystem.id %}" class="btn btn-dark mb-1">Adicionar Nova Meta</a>
    
<br><br>

    <h3><u>Metas</u></h3>
    <ul class="list-group">
        {% for meta in metas %}
            <li class="list-group-item">
                <strong>{{ meta.descricao }}</strong> - {% if meta.concluida %}Concluída{% else %}Pendente{% endif %}
                
                <!-- Editar e Excluir Meta -->               
                <a href="{% url 'editar_meta' meta.id %}" class="btn btn-light mb-1">Editar Meta</a>
                <a href="{% url 'excluir_meta' meta.id %}" class="btn btn-light mb-1">Excluir Meta</a>

                <!-- Adicionar nova ação -->
                <a href="{% url 'nova_acao' meta.id %}" class="btn btn-dark mb-1">Adicionar Nova Ação</a>

                <h3 class="mt-3"><u>Ações</u></h3>
                <ul class="list-group">
                    {% for acao in meta.acoes.all %}
                        <li class="list-group-item">
                            <strong>{{ acao.descricao }}</strong> - {% if acao.concluida %}Concluída{% else %}Pendente{% endif %}
                            
                            <!-- Editar e Excluir Ação -->
                            <a href="{% url 'editar_acao' acao.id %}" class="btn btn-light mb-1">Editar Ação</a>
                            <a href="{% url 'excluir_acao' acao.id %}" class="btn btn-light mb-1">Excluir Ação</a>
                        </li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>

    {% if pdsystem.documentos.all %}
    <h2>Documentos PDF Anexados</h2>
    {% for documento in pdsystem.documentos.all %}
        <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
            <iframe src="{{ documento.pdf_arquivo.url }}" style="position: absolute; top:0; left: 0; width: 100%; height: 600px; border: none;" allowfullscreen></iframe>
        </div>
    {% endfor %}
{% else %}
    <p><em>Nenhum documento PDF anexado.</em></p>
{% endif %}

    <a href="{% url 'home' %}" class="btn btn-dark mb-1">Voltar para a página inicial</a>
</div>
{% endblock %}